(window.webpackJsonp=window.webpackJsonp||[]).push([[106],{2102:function(e,t,r){"use strict";r.r(t);var n=r(1755),a=r.n(n),o=r(565),u=r(80),c=r(119);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){d(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function d(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}t.default=Object(u.a)({namespace:"page",state:{ctx:{pageName:"doc_editor"}},effects:{initializeEditor:regeneratorRuntime.mark((function e(t,r){var n,u,i,d,p,l,f,b,g,m,y;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.payload,u=r.put,i=r.call,d=r.select,p=n.docSlug,e.next=5,d();case 5:return l=e.sent,f=l.book,b=l.group,e.next=10,i(o.c,{book_id:f.id,slug:p,mode:"edit",t:Date.now()});case 10:return g=(g=e.sent).data,m=a()(g.areas,"id"),y=Object.assign({},m,{doc:{id:"doc",draft_version:g.draft_version,locker:g.locker,last_editor:g.last_editor}}),e.next=16,u({type:"doc/update",payload:s(s({},g),{},{editStatus:y})});case 16:return c.a.canMentionMembers("edit",{group:b})&&"Group"===b.type&&0===b.members.length&&u({type:"group/getMembers",payload:{data:{group_id:b.id}}}),e.abrupt("return",g);case 18:case"end":return e.stop()}}),e)})),publish:regeneratorRuntime.mark((function e(t,r){var n,a,u,c,i,s,d,p,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.payload,r.put,a=r.call,u=r.select,e.next=4,u();case 4:return c=e.sent,i=c.doc,s=n.force,d=n.notify,p=n.premium,e.next=9,a(o.f,{data:{id:i.id,force:s,notify:d,premium:p},ignoreGlobalMessage:!0});case 9:return l=e.sent,e.abrupt("return",l);case 11:case"end":return e.stop()}}),e)})),pollingEditingStatus:regeneratorRuntime.mark((function e(t,r){var n,a,u,c,i,s,d,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.payload,a=r.put,u=r.call,c=r.select,e.next=4,c();case 4:return i=e.sent,s=i.doc,d=n.uuid,e.next=9,u(o.d,{id:s.id,uuid:d});case 9:return p=e.sent,e.next=12,a({type:"doc/updateEditStatus",payload:{data:p.data,cover:!1}});case 12:return e.abrupt("return",p.data);case 13:case"end":return e.stop()}}),e)})),lockArea:regeneratorRuntime.mark((function e(t,r){var n,a,u,c,i,s,d,p,l,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.payload,a=r.put,u=r.call,c=r.select,e.next=4,c();case 4:return i=e.sent,s=i.doc,d=n.area,p=n.uuid,e.next=9,u(o.e,{id:s.id,area_id:"doc"===d?null:d,uuid:p,release:!0});case 9:return l=e.sent,(f={})[d]=l.data,e.next=14,a({type:"doc/updateEditStatus",payload:{data:f,cover:!1,action:"lock"}});case 14:return e.abrupt("return",l.data);case 15:case"end":return e.stop()}}),e)})),exitEditor:regeneratorRuntime.mark((function e(t,r){var n,a,u,c,i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.payload,a=r.put,u=r.call,r.select,c=n.id,i=n.uuid,e.next=5,u(o.h,{id:c,uuid:i});case 5:return s=e.sent,e.next=8,a({type:"doc/updateEditStatus",payload:{data:s&&s.data,cover:!1}});case 8:case"end":return e.stop()}}),e)}))}})}}]);